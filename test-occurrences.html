<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Cards de Etapas</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f1f5f9;
        }

        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .test-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .test-header h1 {
            margin: 0;
            font-size: 2.5rem;
        }

        .test-header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }

        /* Estilos dos cards de etapas */
        .stages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stage-card {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stage-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: #e2e8f0;
            transition: all 0.3s ease;
        }

        .stage-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-color: #cbd5e1;
        }

        .stage-card.pending {
            background: #f8fafc;
        }

        .stage-card.pending::before {
            background: #cbd5e1;
        }

        .stage-card.active {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-color: #f59e0b;
        }

        .stage-card.active::before {
            background: #f59e0b;
        }

        .stage-card.completed {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            border-color: #10b981;
        }

        .stage-card.completed::before {
            background: #10b981;
        }

        .stage-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .stage-icon {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            color: white;
            flex-shrink: 0;
        }

        .stage-icon.pending {
            background: #6b7280;
        }

        .stage-icon.active {
            background: #f59e0b;
        }

        .stage-icon.completed {
            background: #10b981;
        }

        .stage-info {
            flex: 1;
            min-width: 0;
        }

        .stage-name {
            font-size: 1rem;
            font-weight: 700;
            color: #1e293b;
            margin: 0 0 5px 0;
            line-height: 1.2;
        }

        .stage-status {
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stage-status.pending {
            color: #6b7280;
        }

        .stage-status.active {
            color: #d97706;
        }

        .stage-status.completed {
            color: #166534;
        }

        .stage-timer {
            background: white;
            border-radius: 8px;
            padding: 12px;
            margin: 15px 0;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .timer-display {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            font-family: 'Courier New', monospace;
            margin-bottom: 5px;
        }

        .timer-label {
            font-size: 0.8rem;
            color: #64748b;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stage-actions {
            display: flex;
            gap: 8px;
            margin-top: 15px;
        }

        .btn-stage {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-start {
            background: #10b981;
            color: white;
        }

        .btn-start:hover {
            background: #059669;
            transform: translateY(-1px);
        }

        .btn-stop {
            background: #ef4444;
            color: white;
        }

        .btn-stop:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .btn-complete {
            background: #3b82f6;
            color: white;
        }

        .btn-complete:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .btn-stage:disabled {
            background: #e2e8f0;
            color: #94a3b8;
            cursor: not-allowed;
            transform: none;
        }

        .btn-stage:disabled:hover {
            background: #e2e8f0;
            transform: none;
        }

        .test-info {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .test-info h3 {
            margin: 0 0 15px 0;
            color: #1e293b;
        }

        .test-info ul {
            margin: 0;
            padding-left: 20px;
        }

        .test-info li {
            margin-bottom: 8px;
            color: #475569;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 10000;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 300px;
            border-left: 4px solid #3b82f6;
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1><i class="fas fa-flask"></i> Teste dos Cards de Etapas</h1>
            <p>Demonstração das novas funcionalidades dos cards de etapas com timer</p>
        </div>

        <div class="test-info">
            <h3><i class="fas fa-info-circle"></i> Como Testar:</h3>
            <ul>
                <li><strong>Iniciar:</strong> Clique em "Iniciar" para começar a contar o tempo</li>
                <li><strong>Pausar:</strong> Clique em "Pausar" para parar o timer (tempo é salvo)</li>
                <li><strong>Concluir:</strong> Clique em "Concluir" para finalizar a etapa</li>
                <li><strong>Timer:</strong> O tempo é atualizado em tempo real</li>
                <li><strong>Status:</strong> As cores mudam conforme o status da etapa</li>
            </ul>
        </div>

        <div class="stages-grid" id="stagesGrid">
            <!-- Cards serão inseridos aqui -->
        </div>
    </div>

    <script>
        // Sistema de teste para os cards de etapas
        class TestStageCards {
            constructor() {
                this.stages = [
                    { name: 'Análise', status: 'pending', time: '0h 0m 0s', timeMs: 0 },
                    { name: 'Desenvolvimento', status: 'active', time: '1h 23m 45s', timeMs: 5025000 },
                    { name: 'Testes', status: 'completed', time: '2h 15m 30s', timeMs: 8130000 },
                    { name: 'Deploy', status: 'pending', time: '0h 0m 0s', timeMs: 0 }
                ];
                
                this.activeTimers = new Map();
                this.stageTimers = new Map();
                
                this.init();
            }

            init() {
                this.initializeTimers();
                this.renderStages();
            }

            initializeTimers() {
                this.stages.forEach((stage, index) => {
                    if (stage.timeMs) {
                        this.stageTimers.set(index, stage.timeMs);
                    }
                });
            }

            renderStages() {
                const grid = document.getElementById('stagesGrid');
                grid.innerHTML = this.stages.map((stage, index) => this.createStageCard(stage, index)).join('');
            }

            createStageCard(stage, index) {
                const statusClass = this.getStatusClass(stage.status);
                const statusText = this.getStatusText(stage.status);
                const stageIcon = this.getStageIcon(stage.status);
                
                let startButton = '';
                let stopButton = '';
                let completeButton = '';
                
                if (stage.status === 'pending') {
                    startButton = `<button class="btn-stage btn-start" onclick="testCards.startStage(${index})">
                        <i class="fas fa-play"></i> Iniciar
                    </button>`;
                } else if (stage.status === 'active') {
                    stopButton = `<button class="btn-stage btn-stop" onclick="testCards.stopStage(${index})">
                        <i class="fas fa-pause"></i> Pausar
                    </button>`;
                    completeButton = `<button class="btn-stage btn-complete" onclick="testCards.completeStage(${index})">
                        <i class="fas fa-check"></i> Concluir
                    </button>`;
                } else if (stage.status === 'completed') {
                    completeButton = `<button class="btn-stage btn-complete" disabled>
                        <i class="fas fa-check"></i> Concluída
                    </button>`;
                }
                
                return `
                    <div class="stage-card ${statusClass}" data-stage-index="${index}">
                        <div class="stage-header">
                            <div class="stage-icon ${statusClass}">
                                <i class="${stageIcon}"></i>
                            </div>
                            <div class="stage-info">
                                <div class="stage-name">${stage.name}</div>
                                <div class="stage-status ${statusClass}">${statusText}</div>
                            </div>
                        </div>
                        
                        <div class="stage-timer">
                            <div class="timer-display" id="timer-${index}">${stage.time}</div>
                            <div class="timer-label">Tempo de Execução</div>
                        </div>
                        
                        <div class="stage-actions">
                            ${startButton}
                            ${stopButton}
                            ${completeButton}
                        </div>
                    </div>
                `;
            }

            startStage(index) {
                const stage = this.stages[index];
                if (!stage) return;

                // Inicializar timer se não existir
                if (!this.stageTimers.has(index)) {
                    this.stageTimers.set(index, 0);
                }
                
                // Iniciar timer
                const startTime = Date.now();
                this.activeTimers.set(index, startTime);
                
                // Atualizar status da etapa
                stage.status = 'active';
                
                // Atualizar interface
                this.updateStageCard(index);
                this.renderStages();
                
                this.showNotification(`Etapa "${stage.name}" iniciada!`, 'success');
            }

            stopStage(index) {
                const stage = this.stages[index];
                if (!stage) return;

                // Parar timer e acumular tempo
                const startTime = this.activeTimers.get(index);
                if (startTime) {
                    const elapsed = Date.now() - startTime;
                    const currentAccumulated = this.stageTimers.get(index) || 0;
                    this.stageTimers.set(index, currentAccumulated + elapsed);
                    this.activeTimers.delete(index);
                }
                
                // Atualizar status da etapa
                stage.status = 'pending';
                
                // Atualizar tempo da etapa
                const totalTime = this.stageTimers.get(index) || 0;
                stage.time = this.formatTime(totalTime);
                stage.timeMs = totalTime;
                
                // Atualizar interface
                this.updateStageCard(index);
                this.renderStages();
                
                this.showNotification(`Etapa "${stage.name}" pausada!`, 'warning');
            }

            completeStage(index) {
                const stage = this.stages[index];
                if (!stage) return;

                // Parar timer e acumular tempo final
                const startTime = this.activeTimers.get(index);
                if (startTime) {
                    const elapsed = Date.now() - startTime;
                    const currentAccumulated = this.stageTimers.get(index) || 0;
                    this.stageTimers.set(index, currentAccumulated + elapsed);
                    this.activeTimers.delete(index);
                }
                
                // Atualizar status da etapa
                stage.status = 'completed';
                
                // Atualizar tempo da etapa
                const totalTime = this.stageTimers.get(index) || 0;
                stage.time = this.formatTime(totalTime);
                stage.timeMs = totalTime;
                
                // Atualizar interface
                this.updateStageCard(index);
                this.renderStages();
                
                this.showNotification(`Etapa "${stage.name}" concluída!`, 'success');
            }

            updateStageCard(index) {
                const timerElement = document.getElementById(`timer-${index}`);
                if (timerElement) {
                    const totalTime = this.stageTimers.get(index) || 0;
                    const isActive = this.activeTimers.has(index);
                    
                    if (isActive) {
                        // Timer ativo - atualizar em tempo real
                        const startTime = this.activeTimers.get(index);
                        const currentElapsed = Date.now() - startTime;
                        const displayTime = totalTime + currentElapsed;
                        timerElement.textContent = this.formatTime(displayTime);
                        
                        // Agendar próxima atualização
                        setTimeout(() => this.updateStageCard(index), 1000);
                    } else {
                        // Timer parado - mostrar tempo acumulado
                        timerElement.textContent = this.formatTime(totalTime);
                    }
                }
            }

            formatTime(milliseconds) {
                const totalSeconds = Math.floor(milliseconds / 1000);
                const hours = Math.floor(totalSeconds / 3600);
                const minutes = Math.floor((totalSeconds % 3600) / 60);
                const seconds = totalSeconds % 60;
                
                if (hours > 0) {
                    return `${hours}h ${minutes}m ${seconds}s`;
                } else if (minutes > 0) {
                    return `${minutes}m ${seconds}s`;
                } else {
                    return `${seconds}s`;
                }
            }

            getStatusClass(status) {
                const classes = {
                    'active': 'active',
                    'completed': 'completed',
                    'pending': 'pending'
                };
                return classes[status] || 'pending';
            }

            getStatusText(status) {
                const texts = {
                    'active': 'Ativa',
                    'completed': 'Concluída',
                    'pending': 'Pendente'
                };
                return texts[status] || 'Pendente';
            }

            getStageIcon(status) {
                const icons = {
                    'completed': 'fas fa-check',
                    'active': 'fas fa-play',
                    'pending': 'fas fa-clock'
                };
                return icons[status] || 'fas fa-clock';
            }

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = 'notification';
                
                const icon = document.createElement('i');
                icon.className = this.getNotificationIcon(type);
                icon.style.color = this.getNotificationColor(type);
                
                const text = document.createElement('span');
                text.textContent = message;
                
                notification.appendChild(icon);
                notification.appendChild(text);
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideInRight 0.3s ease reverse';
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }

            getNotificationColor(type) {
                const colors = {
                    'success': '#10b981',
                    'error': '#ef4444',
                    'warning': '#f59e0b',
                    'info': '#3b82f6'
                };
                return colors[type] || '#3b82f6';
            }

            getNotificationIcon(type) {
                const icons = {
                    'success': 'fas fa-check-circle',
                    'error': 'fas fa-exclamation-circle',
                    'warning': 'fas fa-exclamation-triangle',
                    'info': 'fas fa-info-circle'
                };
                return icons[type] || 'fas fa-info-circle';
            }
        }

        // Inicializar o sistema de teste
        let testCards;
        document.addEventListener('DOMContentLoaded', () => {
            testCards = new TestStageCards();
        });
    </script>
</body>
</html> 